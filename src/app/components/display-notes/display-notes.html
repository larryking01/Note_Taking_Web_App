<article class="layout">
    <app-sidebar />

    <section class="main">
        <app-navbar [pageTitle]="'Notes list'" />

        <div class="notes-content">
            <input type="text" placeholder="Search notes by title, tag or content.." 
                   [(ngModel)]="searchQuery" (ngModelChange)="filterNotes()" class="search-input"/>

                <article *ngIf="allNotes$ | async as notes; else loading">
                    <div *ngIf="notes.length > 0; else noNotes" class="notes-grid">
                        <div *ngFor="let note of filteredNotes" class="note-card">
                            <p class="note-date">{{ note.createdAt }}</p>
                            <h3 class="note-title">{{ note.title }}</h3>
                            <hr />
                            <p class="note-content">{{ note.content }}</p>
                            <p class="tags">
                                <span>
                                    <img src="assets/tags-light.png" class="tag-img" />
                                </span>
                                {{ note.tag }}
                            </p>
                            <p>isArchived: {{ note.isArchived }}</p>
                            
                            <article class="action-btns">
                                <button (click)="navigateToEditNote(note)" class="edit-note-btn">Details</button>
                                <button (click)="archiveNote( note )" class="archive-btn" *ngIf="note.isArchived === false">Archive</button>
                                <button (click)="unarchiveNote( note)"  class="unarchive-btn" *ngIf="note.isArchived === true">Unarchive</button>
                            </article>
                        </div>
                    </div>
                </article>

            <ng-template #loading>
                <p>Loading notes...</p>
            </ng-template>

            <ng-template #noNotes>
                <p>No notes available yet..</p>
            </ng-template>

        </div>

    </section>

</article>
